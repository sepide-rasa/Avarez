@using Kendo.Mvc.UI;
<script src="../../Scripts/json2.min.js" type="text/javascript"></script>
<!--Reference the SignalR library. -->
<script src="~/Scripts/jquery.signalR-1.1.3.js"></script>
<!--Reference the autogenerated SignalR hub script. -->
<script src="~/signalr/hubs"></script>
<script type="text/javascript">
    var hub1 = $.connection.S_hub;
    $(document).ready(function () {
        $.connection.hub.start();
        hub1.client.LoadOnlineUser = function () {
            var grid = $('#Grid').data('kendoGrid');
            $.ajax({
                url: '/OnlineUsers/Reload',
                type: 'get',
                datatype: 'json',                
                error: function (xhr, status, error) {
                    alert(xhr + status);
                },
                success: function (result) {
                    $("#Grid").data("kendoGrid").dataSource.data(result);
                }

            });
        }
        
    });
</script>
    <div class="k-rtl demo-section">
        @(Html.Kendo().Grid<Avarez.Models.LogOnModel>()
                .Name("Grid")
                .Columns(columns =>
                {
                    columns.Bound(p => p.userId).Title("کد").Visible(false);
                    columns.Bound(p => p.Name).Title("نام كاربر");
                    columns.Bound(p => p.IPAdress).Title("آدرس IP");
                    columns.Bound(p => p.Url).Title("موقعيت فعلي");
                })
            .Selectable(selectable => selectable.Mode(GridSelectionMode.Single))
            .Pageable()
                    .HtmlAttributes(new {style="height:600px;" })
            .Scrollable()
            .DataSource(data =>
                data.Ajax()
                .PageSize(30)
                        .Read("Fill", "OnlineUsers")
            )
    )
</div>